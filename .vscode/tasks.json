{
	"version": "2.0.0",
	"inputs": [
		{
			"id": "commitMsg",
			"type": "promptString",
			"description": "Commit message",
			"default": "chore: quick push"
		},
		{
			"id": "tagName",
			"type": "promptString",
			"description": "Tag name (e.g., v3.1.10)",
			"default": "v3.1.10"
		},
		{
			"id": "releaseVersion",
			"type": "promptString",
			"description": "Release version (X.Y.Z, no leading v)",
			"default": "3.2.3"
		},
		{
			"id": "tagMsg",
			"type": "promptString",
			"description": "Tag message",
			"default": "Release"
		},
		{
			"id": "releaseName",
			"type": "promptString",
			"description": "Release display name (GitHub/Gitee)",
			"default": "whois v3.2.3"
		},
		{
			"id": "skipTag",
			"type": "pickString",
			"description": "Skip creating/pushing git tag?",
			"options": ["false", "true"],
			"default": "false"
		},
		{
			"id": "rbHost",
			"type": "promptString",
			"description": "Remote build host (SSH), e.g. your.remote.host",
			"default": "10.0.0.199"
		},
		{
			"id": "rbUser",
			"type": "promptString",
			"description": "Remote SSH user",
			"default": "larson"
		},
		{
			"id": "rbKey",
			"type": "promptString",
			"description": "Private key path (on this PC; Git Bash style, e.g. /c/Users/you/.ssh/id_rsa)",
			"default": "/c/Users/妙妙呜/.ssh/id_rsa"
		},
		{
			"id": "rbSmoke",
			"type": "pickString",
			"description": "Run smoke tests on remote artifacts?",
			"options": [
				"1",
				"0"
			],
			"default": "1"
		},
		{
			"id": "rbQueries",
			"type": "promptString",
			"description": "Smoke queries (space-separated)",
			"default": "8.8.8.8 1.1.1.1"
		},
		{
			"id": "rbSmokeArgs",
			"type": "promptString",
			"description": "Additional Args for Smoke (-a). 留空或输入 NONE 视为无额外参数；示例：-g Domain|Registrar|Name Server|DNSSEC",
			"default": "NONE"
		},
		{
			"id": "rbGolden",
			"type": "pickString",
			"description": "Enable golden check on fetched smoke log? (-G)",
			"options": ["1", "0"],
			"default": "1"
		},
		{
			"id": "rbCflagsExtra",
			"type": "promptString",
			"description": "Per-arch CFLAGS_EXTRA override for make (e.g., -O3 -s). 留空使用脚本默认",
			"default": "-O3 -s"
		},
		{
			"id": "rbSyncDir",
			"type": "promptString",
			"description": "Local sync dir(s) for statics (Git Bash path). 支持多个路径，用 ';' 或 ',' 分隔。",
			"default": "/d/LZProjects/lzispro/release/lzispro/whois;/d/LZProjects/whois/release/lzispro/whois"
		},
		{
			"id": "buildSync",
			"type": "pickString",
			"description": "Run remote build + smoke + sync & push statics?",
			"options": ["true", "false"],
			"default": "true"
		},
		{
			"id": "goldenRawLog",
			"type": "promptString",
			"description": "Raw-mode smoke log path (blank to skip)",
			"default": "./out/artifacts/batch_raw/<timestamp>/build_out/smoke_test.log"
		},
		{
			"id": "goldenHealthLog",
			"type": "promptString",
			"description": "Health-first smoke log path (blank to skip)",
			"default": "./out/artifacts/batch_health/<timestamp>/build_out/smoke_test.log"
		},
		{
			"id": "goldenPlanLog",
			"type": "promptString",
			"description": "Plan-A smoke log path (blank to skip)",
			"default": "./out/artifacts/batch_plan/<timestamp>/build_out/smoke_test.log"
		},
		{
			"id": "goldenPlanBLog",
			"type": "promptString",
			"description": "Plan-B smoke log path (blank to skip)",
			"default": "./out/artifacts/batch_planb/<timestamp>/build_out/smoke_test.log"
		},
		{
			"id": "goldenExtraArgs",
			"type": "promptString",
			"description": "Extra golden_check args (e.g., --strict). 输入 NONE 或留空视为无额外参数。",
			"default": "NONE"
		},
		{
			"id": "prefLabels",
			"type": "promptString",
			"description": "Preference labels for golden pref checks (comma list, e.g., v4-then-v6-hop0; 输入 NONE 或留空视为跳过)",
			"default": "NONE"
		},
		{
			"id": "selftestActions",
			"type": "promptString",
			"description": "Selftest actions for golden (comma list, e.g., force-suspicious,8.8.8.8)",
			"default": "force-suspicious,8.8.8.8"
		},
		{
			"id": "selftestSmokeExtra",
			"type": "promptString",
			"description": "Extra smoke args for remote selftest run (NONE to skip)",
			"default": "--selftest-force-suspicious 8.8.8.8"
		},
		{
			"id": "selftestExpectations",
			"type": "promptString",
			"description": "Semicolon list for --expect spec (e.g., action=force-suspicious,query=8.8.8.8)",
			"default": "action=force-suspicious,query=8.8.8.8"
		},
		{
			"id": "selftestErrors",
			"type": "promptString",
			"description": "Semicolon list of regexes required via --require-error (NONE to skip)",
			"default": "NONE"
		},
		{
			"id": "selftestTags",
			"type": "promptString",
			"description": "Semicolon list of component:regex pairs for --require-tag (NONE to skip)",
			"default": "NONE"
		}
	],
	"tasks": [
		{
			"label": "Git: Quick Push",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/tools/dev/quick_push.ps1",
				"-Message",
				"${input:commitMsg}"
			],
			"group": "build",
			"problemMatcher": []
		},
		{
			"label": "Remote: Build and Sync whois statics",
			"type": "process",
			"command": "C:\\Program Files\\Git\\bin\\bash.exe",
			"args": [
				"-lc",
				"tools/remote/remote_build_and_test.sh -H ${input:rbHost} -u ${input:rbUser} -k '${input:rbKey}' -r ${input:rbSmoke} -q '${input:rbQueries}' -s '${input:rbSyncDir}' -P 1 -a '${input:rbSmokeArgs}' -G ${input:rbGolden} -E '${input:rbCflagsExtra}'"
			],
			"options": {
				"cwd": "${workspaceFolder}"
			},
			"group": "build",
			"problemMatcher": []
		},
		{
			"label": "Remote: Build (Strict Version)",
			"type": "process",
			"command": "C:\\Program Files\\Git\\bin\\bash.exe",
			"args": [
				"-lc",
				"tools/remote/remote_build_and_test.sh -H ${input:rbHost} -u ${input:rbUser} -k '${input:rbKey}' -r ${input:rbSmoke} -q '${input:rbQueries}' -s '${input:rbSyncDir}' -P 1 -a '${input:rbSmokeArgs}' -G ${input:rbGolden} -E '${input:rbCflagsExtra}'"
			],
			"options": {
				"cwd": "${workspaceFolder}",
				"env": {
					"WHOIS_STRICT_VERSION": "1"
				}
			},
			"group": "build",
			"problemMatcher": []
		},
		{
			"label": "Git: Tag Release",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/tools/dev/tag_release.ps1",
				"-Tag",
				"${input:tagName}",
				"-Message",
				"${input:tagMsg}"
			],
			"group": "build",
			"problemMatcher": []
		},
		{
			"label": "One-Click Release",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/tools/release/one_click_release.ps1",
				"-Version",
				"'${input:releaseVersion}'",
				"-GithubName",
				"'${input:releaseName}'",
				"-GiteeName",
				"'${input:releaseName}'",
				"-SkipTagIf",
				"'${input:skipTag}'",
				"-BuildAndSyncIf",
				"'${input:buildSync}'",
				"-RbHost",
				"'${input:rbHost}'",
				"-RbUser",
				"'${input:rbUser}'",
				"-RbKey",
				"'${input:rbKey}'",
				"-RbSmoke",
				"'${input:rbSmoke}'",
				"-RbQueries",
				"'${input:rbQueries}'",
				"-RbSmokeArgs",
				"'${input:rbSmokeArgs}'",
				"-RbGolden",
				"'${input:rbGolden}'",
				"-RbCflagsExtra",
				"'${input:rbCflagsExtra}'",
				"-RbSyncDir",
				"'${input:rbSyncDir}'"
			],
			"group": "build",
			"problemMatcher": []
		},
		{
			"label": "Golden Check: Batch Suite",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/tools/test/golden_check_batch_suite.ps1",
				"-RawLog",
				"${input:goldenRawLog}",
				"-HealthFirstLog",
				"${input:goldenHealthLog}",
				"-PlanALog",
				"${input:goldenPlanLog}",
				"-PlanBLog",
				"${input:goldenPlanBLog}",
				"-ExtraArgs",
				"${input:goldenExtraArgs}",
				"-PrefLabels",
				"${input:prefLabels}"
			],
			"options": {
				"cwd": "${workspaceFolder}"
			},
			"group": "test",
			"problemMatcher": []
		},
		{
			"label": "Remote: Batch Strategy Golden",
			"type": "process",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/tools/test/remote_batch_strategy_suite.ps1",
				"-Host",
				"${input:rbHost}",
				"-User",
				"${input:rbUser}",
				"-KeyPath",
				"${input:rbKey}",
				"-BatchInput",
				"testdata/queries.txt",
				"-CflagsExtra",
				"${input:rbCflagsExtra}",
				"-QuietRemote"
			],
			"options": {
				"cwd": "${workspaceFolder}"
			},
			"group": "test",
			"problemMatcher": []
		},
		{
			"label": "Selftest Golden Suite",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/tools/test/selftest_golden_suite.ps1",
				"-RemoteHost",
				"${input:rbHost}",
				"-User",
				"${input:rbUser}",
				"-KeyPath",
				"${input:rbKey}",
				"-Queries",
				"${input:rbQueries}",
				"-CflagsExtra",
				"${input:rbCflagsExtra}",
				"-SelftestActions",
				"${input:selftestActions}",
				"-SmokeExtraArgs",
				"${input:selftestSmokeExtra}",
				"-SelftestExpectations",
				"${input:selftestExpectations}",
				"-ErrorPatterns",
				"${input:selftestErrors}",
				"-TagExpectations",
				"${input:selftestTags}"
			],
			"options": {
				"cwd": "${workspaceFolder}"
			},
			"group": "test",
			"problemMatcher": []
		}
	]
}