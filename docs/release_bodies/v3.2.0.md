# whois v3.2.0

A tiny, portable whois client purpose-built for BusyBox pipelines.

- Smart redirects: non-blocking connect, timeouts, light retries; follow referrals with loop guard (cap via -R, disable with -Q).
- Pipeline batch input: stable header/tail contract; stdin-driven (-B/implicit); ideal for large-scale grep/awk flows.
- Conditional output engine: title projection (-g) → regex filters (--grep/--grep-cs, line/block, optional continuation expansion) → single-line folded summary (--fold, sep/case options).

一个为 BusyBox 管道而生的轻量 whois 客户端：

- 智能重定向：非阻塞连接、超时、轻量重试；自动跟随转发（-R 上限，-Q 禁用），内置循环保护。
- 管道化批量输入：稳定“首行标题 + 尾行权威 RIR”契约；支持标准输入（-B/隐式），适合大批量 grep/awk 流水线。
- 条件输出引擎：标题投影（-g）→ 正则筛查（--grep/--grep-cs，行/块 + 可选续行展开）→ 单行折叠（--fold，分隔符/大小写可调）。

---

## Highlights / 亮点

- Regex filtering & selection modes: `--grep/--grep-cs`; choose line/block (`--grep-line`/`--grep-block`); line mode supports continuation expansion (`--keep-continuation-lines`).
- Folded output: `--fold` prints `<query> <UPPER_VALUE_...> <RIR>`; `--fold-sep <SEP>` sets separators (space, \t/\n/\r/\s); `--no-fold-upper` preserves case.
- Continuation-line keyword tips: Strategy A (`-g` + block `--grep` + `--fold`) recommended; Strategy B (line-mode OR + `--keep-continuation-lines` + `--fold`) is flexible but may overmatch.
- 文档增强：新增“续行关键词命中技巧（策略 A/B）”、折叠前后示意图与处理流程图；README 亮点加粗。

## Quickstart

```bash
# Linux / Git Bash
whois-x86_64 8.8.8.8
whois-x86_64 --host apnic -Q 103.89.208.0
printf "8.8.8.8\n1.1.1.1\n" | whois-x86_64 -B -g 'netname|e-mail' --grep 'GOOGLE|CLOUDFLARE' --grep-line --fold
```

```powershell
# Windows PowerShell
whois-x86_64.exe 8.8.8.8
whois-x86_64.exe --host apnic -Q 103.89.208.0
"8.8.8.8`n1.1.1.1" | .\whois-x86_64.exe -B -g 'netname|e-mail' --grep 'GOOGLE|CLOUDFLARE' --grep-line --fold
```

## Docs & Links

- Usage (CN): docs/USAGE_CN.md
- Usage (EN): docs/USAGE_EN.md
- Continuation tips: CN `docs/USAGE_CN.md#续行关键词命中技巧推荐策略与陷阱` | EN `docs/USAGE_EN.md#continuation-line-keyword-capture-tips-recommended`
- Fold before/after: `docs/images/fold-before-after.svg`
- Pipeline diagram: `docs/images/pipeline.svg`

## Artifacts

- GitHub Release attaches: `whois-x86_64-gnu` (CI build), checksum, and seven fully static multi-arch binaries via remote toolchains.

